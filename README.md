# Phone Hashing Service

## Начало
1. Загрузите архив с проектом и откройте его в **IntelliJ IDEA**.
2. Дождитесь загрузки зависимостей.

## Шаги по запуску тестов

1. Запустите команду:
   ```sh
   docker-compose -f docker-compose-test.yml up --build
   ```
2. После успешного прохождения тестов контейнеры можно удалить.
   ```sh
   docker-compose -f docker-compose-test.yml down
   ```


## Шаги по запуску сервиса

1. Перед запуском производственного окружения **удалите предыдущую сеть контейнеров**.
2. Откройте терминал и выполните команду:
   ```sh
   docker-compose -f docker-compose-prod.yml up --build
   ```
   **Важно!** В этом профиле загружается **50 000 000 записей** в базу данных с помощью миграций.
3. Время загрузки можно отслеживать по логам миграции №5 (около 4 мин.) или через **Spring Actuator**:
    - http://localhost:8080/actuator/metrics/process.start.time
    - http://localhost:8080/actuator/metrics/process.uptime

   (Метрика `startup` в используемой версии Actuator недоступна.)
4. Для просмотра метрик также используйте **Postman**.
5. Укажите во вкладке **Authorization**:
    - **Тип:** `Basic Auth`
    - **Username:** `user`
    - **Password:** `password`

### Доступные API

- **POST** `http://localhost:8080/V1/api/hash?phoneNumber=380000000010` - Создание хеша для номера телефона.
- **GET** `http://localhost:8080/V1/api/dehash?hash=nvGIJAaPDn6W6o6xRfx6D5efEps=` - Получение номера телефона по хешу.


## Описание API

### `POST /V1/api/hash`
Создает и возвращает хеш для переданного номера телефона.

**Параметры:**
- `phoneNumber` (query-параметр) - номер телефона в формате `380XXXXXXXXX`.

**Ответ:**
- `200 OK` - успешное создание хеша (строка-хеш).
- `400 Bad Request` - номер телефона не соответствует формату.

### `GET /V1/api/dehash`
Возвращает номер телефона по переданному хешу.

**Параметры:**
- `hash` (query-параметр) - строка-хеш.

**Ответ:**
- `200 OK` - найденный номер телефона.
- `404 Not Found` - номер телефона не найден.

## Возможные улучшения

- **Добавить асинхронность** в методы сервиса.
- **Выбрать и задать конкретный алгоритм шифрования** (сейчас он задается динамически).
- **Оптимизировать алгоритм записи на уровне БД** (например, с использованием batch-инсертов или индексов).
- **Усложнить security** (например, добавить JWT, ограничить доступ к API).
- **Валидировать входные хеши** перед обработкой.
- **Реализовать единый стандарт обработки ошибок** (например, через `@ControllerAdvice`).
- **Сделать замеры времени прохождения запроса в тестах**

## Скорость заполнения

- `50 000 000` - 4 мин 20 сек.
- `1 GET или POST запрос` - от 4 до 18 ms.
